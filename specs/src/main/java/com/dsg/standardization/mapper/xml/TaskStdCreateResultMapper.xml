<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.dsg.standardization.mapper.TaskStdCreateResultMapper">

    <!-- 可根据自己的需求，是否要使用 -->
    <resultMap type="com.dsg.standardization.entity.TaskStdCreateResultEntity" id="baseMap">
        <result property="id" column="f_id"/>
        <result property="taskId" column="f_task_id"/>
        <result property="tableField" column="f_table_field"/>
        <result property="tableFieldDescription" column="f_table_field_description"/>
        <result property="stdRefFile" column="f_std_ref_file"/>
        <result property="stdCode" column="f_std_code"/>
        <result property="stdChName" column="f_std_ch_name"/>
        <result property="stdEnName" column="f_std_en_name"/>
    </resultMap>

    <select id="queryRelationStdNumber" resultType="com.dsg.standardization.vo.TaskVo">
        select f_task_id as id, count(f_std_code) as relationField, count(1) as totalField
        from t_de_task_std_create_result t
        where f_task_id in
        <foreach collection="taskIds" item="item" open="(" separator="," close=")">
            #{item}
        </foreach>
        group by id
    </select>

    <select id="queryByTaskId" resultType="com.dsg.standardization.vo.TaskResultVo">
        select
        t1.f_id as id,
        t1.f_table_field as tableField,
        t1.f_table_field_description as tableFieldDescription,
        t1.f_std_ref_file as stdRefFile,
        t1.f_std_code as stdCode,
        t1.f_rec_std_code as recStdCode,
        t1.f_std_ch_name as stdChName,
        t1.f_std_en_name as stdEnName
        from t_de_task_std_create_result t1
        left join t_data_element_info t2
        on t2.f_de_code = t1.f_std_code
        where t1.f_task_id = #{taskId}
        order by t1.f_std_code asc,f_id asc
    </select>


    <update id="cleanStdCode">
        update t_de_task_std_create_result
        set f_std_code = null, f_std_ch_name = null,f_std_en_name = null
        where f_id in
        <foreach collection="ids" item="item" open="(" separator="," close=")">
            #{item}
        </foreach>
    </update>


</mapper>